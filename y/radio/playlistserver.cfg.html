<style>

.bordered {
  border: solid #ccc 3px;
  border-radius: 6px;
}

.bordered td, .bordered th {
  border-left: 2px solid #ccc;
  border-top: 2px solid #ccc;
  padding: 10px;
}

.btn:active{
  background-color: #666;
  color: white;
}

input[type="radio"] {
  width: 30px;
  height: 30px;
  border-radius: 15px;
  border: 2px solid #1FBED6;
  background-color: white;
  -webkit-appearance: none; /*to disable the default appearance of radio button*/
  -moz-appearance: none;
}

input[type="radio"]:focus { /*no need, if you don't disable default appearance*/
  outline: none; /*to remove the square border on focus*/
}

input[type="radio"]:checked { /*no need, if you don't disable default appearance*/
  background-color: #1FBED6;
}

input[type="radio"]:checked ~ span:first-of-type {
  color: white;
}

label span:first-of-type {
  position: relative;
  left: -150px;
  font-size: 15px;
  color: #1FBED6;
}

label span {
  position: relative;
  top: -12px;
}

</style>

<script type="text/javascript" charset="utf-8">

function lpad(a, b, c){ // lpad('4, '0', 3); => 004
	return String(a).padStart(c, b);
}

function ofuscador_uri(){	
	let a=window.location.pathname;
	if ( a.indexOf('/k=') != 0 && a.indexOf('/') == 0 && a.length > 1 ){
		a=a.substring(1);
		let s='';
		for (let i = 0; i < a.length; i++)
			s += lpad(a.charCodeAt(i).toString(2), '0', 8);
		window.location.pathname='/k='+s.replaceAll('0', 'I').replaceAll('1', 'l');// I L
	}
}

function btoa2(str) {
    return btoa(encodeURIComponent(str).replace(/%([0-9A-F]{2})/g,
        function toSolidBytes(match, p1) {
            return String.fromCharCode('0x' + p1);
    }));
}

function send(a){
	if ( a.replaceAll(' ','') != a ){
		// se tirar essas duas linhas o celular buga!
		// header muito grande buga no celular
		t1=btoa2(a.trim().split('\n').map(item => item.trim()).join('|'));
		try{
			t2=btoa(a.trim().split('\n').map(item => item.trim()).join('|'));
		} catch (error) {
			let tmp=a.trim().split('\n');
			for ( let i=0;i<tmp.length;i++ ){
				try{
					btoa(tmp[i]);
				} catch (error) {
					alert(error + ' - ' + tmp[i]);
					break;
				}
			}
		}
		a="base64 " + t1;
		//a=a.split('\n').map(item => item.trim()).join('|');
	}
	var xmlHttp = new XMLHttpRequest();
	xmlHttp.open('GET', window.location.pathname, false);
	xmlHttp.setRequestHeader('acao', a); // espaço adicionar para o mobile não bugar!
	xmlHttp.send(null);
	return xmlHttp.responseText;
}


function get_custom_start(sec_default, name){
	let matrix={
		"D:\\ProgramFiles\\site\\musicas\\classicas\\Rhapsody In Blue - Gershwin.webm": 5,
		"D:\\ProgramFiles\\site\\musicas\\classicas\\12 Continent - The Journey.mkv": 1,
		"D:\\ProgramFiles\\site\\musicas\\classicas\\Adagio for Strings, Op. 11.mkv": 5,
		"D:\\ProgramFiles\\site\\musicas\\classicas\\Beethoven - Moonlight Sonata (FULL).webm": 1,
		"D:\\ProgramFiles\\site\\musicas\\classicas\\Chopin - Nocturne op.9 No.2.webm": 2,
		"D:\\ProgramFiles\\site\\musicas\\twosteps\\21 - Breathe.mp3": 1,
		"D:\\ProgramFiles\\site\\musicas\\classicas\\Carl Orff - O Fortuna ~ Carmina Burana.mkv": 2,
		"D:\\ProgramFiles\\site\\musicas\\classicas\\Dies Irae (Requiem) - Giuseppe Verdi - LEGENDADO PT_BR.mp4": 5,
		"D:\\ProgramFiles\\site\\musicas\\classicas\\Edvard Grieg - Peer Gynt - Suite No. 1, Op. 46 - I. Morning Mood.webm": 1,
		"D:\\ProgramFiles\\site\\musicas\\classicas\\Everyday - Carly Comando.webm": 1,
		"D:\\ProgramFiles\\site\\musicas\\classicas\\J.S. Bach - Toccata and Fugue in D minor BWV 565.webm": 1,
		"D:\\ProgramFiles\\site\\musicas\\classicas\\K. 183 Mozart Symphony No. 25 in G minor, I Allegro con brio.mkv": 1,
		"D:\\ProgramFiles\\site\\musicas\\classicas\\Mozart - Lacrimosa-k1.mkv": 2,
		"D:\\ProgramFiles\\site\\musicas\\classicas\\Puccini - Gianni Schicchi - 'O mio babbino caro'.webm": 5,
		"D:\\ProgramFiles\\site\\musicas\\classicas\\Tchaikovsky - Piano Concerto No .1 In B Flat Minor, Op. 23 - Allegro Non Troppo E Molto Maestoso.webm": 2,
		"D:\\ProgramFiles\\site\\musicas\\classicas\\The Four Seasons - Summer in G Minor, RV. 315 - III. Presto.mkv": 1,
		"D:\\ProgramFiles\\site\\musicas\\populares\\Adele - Rolling in the Deep.mp3": 5,
		"D:\\ProgramFiles\\site\\musicas\\rock\\Dire Straits - Sultans Of Swing (Official Music Video)-h0ffIJ7ZO4U.mkv": 1,
		"D:\\ProgramFiles\\site\\musicas\\twosteps\\30 - Impossible.webm": 3,
		"fim": 0
	}
	if ( sec_default >= 0 )
		return sec_default;		
	if ( typeof matrix[name] != 'undefined' )
		return matrix[name];
	else
		console.log('analisando start: '+name.replaceAll('\\', '\\\\'));
	return 0;
}


function get_custom_vol(vol_default, name){ // VOLUMEEEE
	let matrix={
		"D:\\ProgramFiles\\site\\musicas\\classicas\\12 Continent - The Journey.mkv": 0.3,
		"D:\\ProgramFiles\\site\\musicas\\classicas\\Peer Gynt, Op. 23 - IV. In the Hall of the Mountain King.mkv": 6,
		"D:\\ProgramFiles\\site\\musicas\\classicas\\Puccini - Gianni Schicchi - 'O mio babbino caro'.webm": 3,
		"D:\\ProgramFiles\\site\\musicas\\classicas\\Sarah Brightman And Andrea Bocelli - Time To Say Goodbye [The Best of Andrea Bocelli - 'Vivere'].webm": 0.7,
		"D:\\ProgramFiles\\site\\musicas\\classicas\\The Four Seasons - Summer in G Minor, RV. 315 - III. Presto.mkv": 0.30,
		"D:\\ProgramFiles\\site\\musicas\\classicas\\Thoughts.mkv": 0.55,
		"D:\\ProgramFiles\\site\\musicas\\rock\\Dire Straits - Sultans Of Swing (Official Music Video)-h0ffIJ7ZO4U.mkv": 0.5,
		"fim": 1
	}
	if ( typeof matrix[name] != 'undefined' )
		return matrix[name];
	if ( name.indexOf("D:\\ProgramFiles\\site\\musicas\\angra\\") == 0 )
		return 0.16;
	if ( name.indexOf("D:\\ProgramFiles\\site\\musicas\\populares\\") == 0 )
		return 0.50;
	if ( name.indexOf("D:\\ProgramFiles\\site\\musicas\\systemOfADown - Hypnotize\\") == 0 )
		return 0.40;
	if ( name.indexOf("D:\\ProgramFiles\\site\\musicas\\twosteps\\") == 0 )
		return 0.40;
	return 1;
}

function minisend(a, c, n){
	if ( typeof n == 'undefined' )
		n=0;
	let b=document.querySelector('input[name="vol"]:checked').value;
	let faixas=a.trim().split('\n').map(item => item.trim());
	let n_faixas=faixas.length;
	let s='\nn_faixas '+n_faixas+'\n';
	let first=null;
	let device='tv';
	for ( let i=0;i<n_faixas;i++ ){
		s+='faixa '+i+' '+faixas[i]+'\n';
		s+='cfg faixa '+i+' ' + get_custom_vol(1, faixas[i]) + ' ' + get_custom_start(c, faixas[i]) + '\n';
	}
	s+='vol worker '+b+'\n';
	s=`name_worker TMP
		worker_loop yes
		path_vlc C:\\Program Files\\VideoLAN\\VLC
		device ` + device + s + 'play faixa '+n;
	s=s.trim().split('\n').map(item => item.trim()).join('\n');
	s=send(s);
	if ( s != '..' )
		alert(s);
	return s;
}

function exemplo_call_minisend(){
	return minisend(
		`D:\\ProgramFiles\\site\\musicas\\classicas\\12 Continent - The Journey.mkv
		D:\\ProgramFiles\\site\\musicas\\classicas\\End Credits (From 'Pirates of the Caribbean - On Stranger Tides'_Score).mkv`	
		, 0
	);

}

function exemplo_call_send(a){
	return send(
		`name_worker TMP
		worker_loop no
		device auto
		n_faixas 2
		faixa 0 D:\\ProgramFiles\\site\\musicas\\systemOfADown - Hypnotize\\04 - Hypnotize.webm
		faixa 1 D:\\ProgramFiles\\site\\musicas\\systemOfADown - Hypnotize\\04 - Hypnotize.webm
		vol worker 0.1
		cfg faixa 0 1 0
		cfg faixa 1 1 0
		path_vlc C:\\Program Files\\VideoLAN\\VLC
		play faixa 0`
	);
}

function send2(a){
	return minisend(
		`D:\\ProgramFiles\\site\\musicas\\classicas\\Rhapsody In Blue - Gershwin.webm
		D:\\ProgramFiles\\site\\musicas\\classicas\\Rhapsody In Blue - Gershwin.webm`	
		, 0
	);
}

this.path='/';
this.list=[];
this.len_base=0;

function get_paths(a){
	a='A'+a+'A';
	a=a.split('/');
	a.shift();
	a.pop();
	return a;
}

function set_base(){
	this.len_base=get_paths(this.path).length;
}

function get_lista(a){
	let paths=get_paths(a);
	let s={};
	for ( let i=0;i<this.list.length;i++ ){
		let tmp=get_paths(this.list[i]);
		if ( tmp.length > paths.length ){
			let impedimento=false;
			for ( let j=0;j<paths.length;j++ ){
				if ( paths[j] != tmp[j] ){
					impedimento=true;
					break;
				}
			}		
			if ( !impedimento )
				s[tmp[paths.length]]=true;
		}
	}
	return Object.keys(s);
}

this.z=null;
function update_click(a){
	if ( a.innerHTML == 'PLAY - ' )
		update(a.parentElement.children[1].innerHTML.replaceAll('&nbsp;',''), a);
	else
		update(a.parentElement.children[1].innerHTML.replaceAll('&nbsp;',''));
}

function update(a, aux_play){
	if ( typeof aux_play != 'undefined' ){
		let a=aux_play.parentElement.parentElement;
		let b=aux_play.parentElement.parentElement.parentElement;
		let filhos=b.children;
		let n=0;
		for ( let i=0;i<filhos.length;i++ ){
			if ( filhos[i] == a )
				n=i-1;
		}
		play(n);
		return;
	}
	if ( a == '..' && path == '/' )
		return;
	if ( a == '.' ){
		//ok
	}else{
		if ( a == '..' ){
			let s=get_paths(this.path);
			if ( s.length <= this.len_base ) // block
				return;
			if ( s.length > 0 )
				s.pop();
			if ( s.length == 0 )
				this.path='/';
			else
				this.path='/'+s.join('/')+'/';
		}else
			path+=a+'/';
	}
	let lista=get_lista(this.path);
	let s='';
	let px='900px';
	let f_play='';
	if ( lista.length > 0 && lista[0].indexOf('.') > -1 )
		f_play='<a onclick="update_click(this)">PLAY - </a>';
	else
		f_play='<a>&nbsp;</a>';
	s+='<tr>';
	s+='<td style="width: '+px+'; display: inline-block; cursor: pointer; color: black; font-size: 44px; font-family: Franklin Gothic Medium;"><a></a><a onclick="update_click(this)">..&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</a></td>';
	s+='</tr>';
	for ( let i=0;i<lista.length;i++ ){
		s+='<tr>';
		s+='<td style="width: '+px+'; display: inline-block; cursor: pointer; color: black; font-size: 44px; font-family: Franklin Gothic Medium;"">'+f_play+'<a onclick="update_click(this)">'+lista[i]+'</a></td>';
		s+='</tr>';
	}
	document.getElementById('tablebase').innerHTML=s;
	s=get_paths(this.path);
	for ( let i=0;i<this.len_base;i++ )
		s.shift();
	s=s.join('/');
	document.getElementById('div_path').innerHTML=s;
}

function f_load(){
	ofuscador_uri();
	this.list=send('list').split('|').map(a => '/'+a.replaceAll('\\', '/')+'/');	
	this.path='/D:/ProgramFiles/site/musicas/';
	set_base();
	this.path='/D:/ProgramFiles/site/musicas/classicas/Rhapsody In Blue - Gershwin.webm/';
	update('.');
}

function format_and_send_play(a, n){
	a=a.split('\n');
	a=a.map(a => a.substring(1)).map(a => a.substring(0, a.length-1).replaceAll('/', '\\')).join('\n');
	minisend(a, -1, n);
}

function play(n){
	let s=get_paths(this.path);
	if ( s.length > 0 && s[s.length-1].indexOf('.') > -1 )
		format_and_send_play(this.path, n);		
	else{
		let s2=get_lista(this.path);
		if ( s2.length > 0 && s2[s2.length-1].indexOf('.') > -1 ){
			let s3='';
			for ( let i=0;i<s2.length;i++ )
				s3+=this.path+s2[i]+'/\n';							
			format_and_send_play(s3, n);
		}else
			alert('selecione a pasta de musica ou a musica!');
		
	}
}
</script>


<html>
<body onload="f_load()">

<br><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<button style="height: 181px; font-size:70px; width: 316px;" class="btn" type="submit" onclick="send('stop')">&nbsp;&nbsp;&nbsp;STOP&nbsp;&nbsp;&nbsp;&nbsp;</button>
	&nbsp;<button style="height: 181px; font-size:70px; width: 316px;" class="btn" type="submit" onclick="alert(send('status'))">&nbsp;&nbsp;&nbsp;STAT&nbsp;&nbsp;&nbsp;&nbsp;</button>

<br><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<button style="height: 181px; font-size:70px; width: 316px;" class="btn" type="submit" onclick="location.reload()">RELOAD&nbsp;&nbsp;</button>
	&nbsp;<button style="height: 181px; font-size:70px; width: 316px;" class="btn" type="submit" onclick="play()">&nbsp;&nbsp;&nbsp;PLAY&nbsp;&nbsp;&nbsp;&nbsp;</button>

<br><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<button style="height: 181px; font-size:70px; width: 316px;" class="btn" type="submit" onclick="send('back')">BACK&nbsp;&nbsp;</button>
	&nbsp;<button style="height: 181px; font-size:70px; width: 316px;" class="btn" type="submit" onclick="send('next')">&nbsp;&nbsp;&nbsp;NEXT&nbsp;&nbsp;&nbsp;&nbsp;</button>

<br><br><br><br>
<a id="div_path" style="width: 700px; color: black; font-size: 44px; font-family: Franklin Gothic Medium;">...</a>
<br>
<table id="tablebase" class="bordered" style="font-family:Verdana,sans-serif;font-size:10px;border-spacing: 0;"></table>
<br><br><br><br>






<label><input type="radio" name="vol" style="height: 70px; font-size:70px; width: 170px;" value="0.01"        /><span style="height: 70px; font-size:70px; width: 70px;">0.01</span></label>
<label><input type="radio" name="vol" style="height: 70px; font-size:70px; width: 170px;" value="0.02"        /><span style="height: 70px; font-size:70px; width: 70px;">0.02</span></label>
<label><input type="radio" name="vol" style="height: 70px; font-size:70px; width: 170px;" value="0.03" checked/><span style="height: 70px; font-size:70px; width: 70px;">0.03</span></label><br>
<label><input type="radio" name="vol" style="height: 70px; font-size:70px; width: 170px;" value="0.06"        /><span style="height: 70px; font-size:70px; width: 70px;">0.06</span></label>
<label><input type="radio" name="vol" style="height: 70px; font-size:70px; width: 170px;" value="0.09"        /><span style="height: 70px; font-size:70px; width: 70px;">0.09</span></label>
<label><input type="radio" name="vol" style="height: 70px; font-size:70px; width: 170px;" value="0.12"        /><span style="height: 70px; font-size:70px; width: 70px;">0.12</span></label><br>
<label><input type="radio" name="vol" style="height: 70px; font-size:70px; width: 170px;" value="0.15"        /><span style="height: 70px; font-size:70px; width: 70px;">0.15</span></label>
<label><input type="radio" name="vol" style="height: 70px; font-size:70px; width: 170px;" value="0.18"        /><span style="height: 70px; font-size:70px; width: 70px;">0.18</span></label>
<label><input type="radio" name="vol" style="height: 70px; font-size:70px; width: 170px;" value="0.21"        /><span style="height: 70px; font-size:70px; width: 70px;">0.21</span></label><br>
<label><input type="radio" name="vol" style="height: 70px; font-size:70px; width: 170px;" value="0.24"        /><span style="height: 70px; font-size:70px; width: 70px;">0.24</span></label>
<label><input type="radio" name="vol" style="height: 70px; font-size:70px; width: 170px;" value="0.27"        /><span style="height: 70px; font-size:70px; width: 70px;">0.27</span></label>
<label><input type="radio" name="vol" style="height: 70px; font-size:70px; width: 170px;" value="0.30"        /><span style="height: 70px; font-size:70px; width: 70px;">0.30</span></label><br>
<label><input type="radio" name="vol" style="height: 70px; font-size:70px; width: 170px;" value="0.40"        /><span style="height: 70px; font-size:70px; width: 70px;">0.40</span></label>
<label><input type="radio" name="vol" style="height: 70px; font-size:70px; width: 170px;" value="0.50"        /><span style="height: 70px; font-size:70px; width: 70px;">0.50</span></label>
<label><input type="radio" name="vol" style="height: 70px; font-size:70px; width: 170px;" value="0.60"        /><span style="height: 70px; font-size:70px; width: 70px;">0.60</span></label><br>
<label><input type="radio" name="vol" style="height: 70px; font-size:70px; width: 170px;" value="0.70"        /><span style="height: 70px; font-size:70px; width: 70px;">0.70</span></label>
<label><input type="radio" name="vol" style="height: 70px; font-size:70px; width: 170px;" value="0.80"        /><span style="height: 70px; font-size:70px; width: 70px;">0.80</span></label>
<label><input type="radio" name="vol" style="height: 70px; font-size:70px; width: 170px;" value="1.00"        /><span style="height: 70px; font-size:70px; width: 70px;">1.00</span></label><br>
</body>
</html>
